#!/bin/bash

cd ~/projects/adobe/hz/main
trees=$(git worktree list)
while IFS= read -r line; do
    items=($line)
    worktree="${items[0]}"
    branch="${items[2]}"
    branch=$(echo $branch | cut -d "[" -f2 | cut -d "]" -f1)
    if [[ $branch =~ "main" ]]; then 
      continue
    fi

    echo "Deleting worktree for branch $branch"

    git worktree remove --force $worktree
done <<< "$trees"
exit

branches=$(git branch --list --format='%(refname:short)' | grep -v "main")

while IFS= read -r branch; do
  git branch -d $branch
done <<< "$branches"
