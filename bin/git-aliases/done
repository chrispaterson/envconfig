#!/bin/bash

pr_state=$(gh pr status --json state -q '.currentBranch.state')

if [[ $pr_state == "OPEN" ]]; then
  echo "This still has an open PR!"
fi
exit

issue=$(echo $branch | cut -d"/" -f2)

branch=$(git rev-parse --abbrev-ref HEAD)
mergeBase=$(git merge-base main $branch) 
if [[ $(git cherry main $(git commit-tree $(git rev-parse "$branch^{tree}") -p $mergeBase -m _)) == "-"* ]]; then
 git branch -D $branch
 jira issue move "$issue" "Done" 
else
  echo "This branch does not seem to be merged into main"
  exit 1
fi

